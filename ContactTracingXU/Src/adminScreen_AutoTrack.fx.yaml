adminScreen_AutoTrack As screen:

    "'htmlText_HealthCheck-up_14' As htmlViewer":
        Height: =562
        HtmlText: |-
            ="<div style='background-color: rgba(0,0,0,0); box-shadow: 0px 3px 6px 0px rgba(89,87,87,0.85); margin: 12px; width: 608px; height: 510px; border-radius: 15px'></div>"
        OnSelect: =
        Width: =640
        Y: =568
        ZIndex: =3

    "'htmlText_HealthCheck-up_13' As htmlViewer":
        Height: =399
        HtmlText: |-
            ="<div style='background-color: rgba(0,0,0,0); box-shadow: 0px 3px 6px 0px rgba(89,87,87,0.85); margin: 12px; width: 608px; height: 360px; border-radius: 15px'></div>"
        OnSelect: =
        Width: =640
        Y: =175
        ZIndex: =4

    TextInput4 As text:
        BorderThickness: =1
        Color: =RGBA(0, 18, 107, 1)
        Default: =""
        Font: =Font.'Lato Hairline'
        FontWeight: =FontWeight.Semibold
        Height: =53
        HintText: ="Confirmed Covid Patient's XU Email"
        Size: =21
        Width: =552
        X: =45
        Y: =396
        ZIndex: =6

    dp_From As datepicker:
        BorderThickness: =1
        Color: =RGBA(0, 18, 107, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Semibold
        Height: =49
        IconBackground: =RGBA(0, 18, 107, 1)
        Size: =24
        Width: =317
        X: =45
        Y: =240
        ZIndex: =7

    dp_To As datepicker:
        BorderThickness: =1
        Color: =RGBA(0, 18, 107, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =49
        IconBackground: =RGBA(0, 18, 107, 1)
        Size: =24
        Width: =317
        X: =45
        Y: =317
        ZIndex: =8

    Label21 As label:
        Color: =RGBA(0, 13, 75, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =25
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="From"
        Width: =86
        X: =45
        Y: =218
        ZIndex: =9

    Label21_1 As label:
        Color: =RGBA(0, 13, 75, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =18
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="To"
        Width: =48
        X: =45
        Y: =299
        ZIndex: =10

    fromDropDown_Hour_1 As dropdown:
        BorderThickness: =1
        ChevronBackground: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: ="00"
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Semibold
        Height: =49
        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
        Size: =24
        Width: =105
        X: =373
        Y: =240
        ZIndex: =11

    fromDropDown_Mins_1 As dropdown:
        BorderThickness: =1
        ChevronBackground: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: ="00"
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Semibold
        Height: =49
        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
        Size: =24
        Width: =105
        X: =492
        Y: =240
        ZIndex: =12

    toDropDown_Hour_1 As dropdown:
        BorderThickness: =1
        ChevronBackground: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: ="23"
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Semibold
        Height: =49
        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
        Size: =24
        Width: =105
        X: =373
        Y: =317
        ZIndex: =13

    toDropDown_Mins_1 As dropdown:
        BorderThickness: =1
        ChevronBackground: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: ="59"
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Semibold
        Height: =49
        Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
        Size: =24
        Width: =106
        X: =491
        Y: =317
        ZIndex: =14

    Label21_2 As label:
        Color: =RGBA(0, 13, 75, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =25
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="XU Email"
        Width: =147
        X: =47
        Y: =373
        ZIndex: =15

    Label5_4 As label:
        Align: =Align.Center
        Color: =RGBA(0, 18, 107, 1)
        Font: =Font.'Lato Hairline'
        FontWeight: =FontWeight.Bold
        Height: =148
        Size: =50
        Text: ="Send Notifications to Close Contacts"
        Width: =591
        X: =23
        Y: =27
        ZIndex: =16

    Label21_3 As label:
        Align: =Align.Right
        Color: =RGBA(0, 13, 75, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =30
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="Message for Notification"
        Width: =261
        X: =353
        Y: =586
        ZIndex: =19

    Label21_4 As label:
        Align: =Align.Right
        Color: =RGBA(0, 13, 75, 1)
        Font: =Font.'Lato Light'
        FontWeight: =FontWeight.Bold
        Height: =23
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =12
        Text: ="Close Contact Info"
        Width: =157
        X: =459
        Y: =195
        ZIndex: =20

    btn_fcc As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =22

        "'htmlText_HealthCheck-up_15' As htmlViewer":
            Height: =81
            HtmlText: |-
                ="<div style='background-color: rgba(0,0,0,0); box-shadow: 0px 2px 4px 0px rgba(89,87,87,0.85); margin: 10px; width: 140px; height: 50px; border-radius: 15px'></div>"
            Width: =165
            X: =437
            Y: =465
            ZIndex: =2

        Button9 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =0
            Color: =RGBA(0, 18, 107, 1)
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.'Lato Light'
            Height: =50
            HoverBorderColor: =
            OnSelect: |
                =Clear(collectCloseContact);
                ClearCollect(
                    collectUserTimeStampsForCertainTime,
                    ShowColumns(
                        Filter(
                            UserScanRoom,
                            userEmail = TextInput4.Text && timeOut <= dp_To.SelectedDate + Time(
                                Value(toDropDown_Hour_1.Selected.Value),
                                Value(toDropDown_Mins_1.Selected.Value),
                                0
                            ) && timeIN >= dp_From.SelectedDate + Time(
                                Value(fromDropDown_Hour_1.Selected.Value),
                                Value(fromDropDown_Mins_1.Selected.Value),
                                0
                            )
                        ),
                        "ID",
                        "Title",
                        "timeIN",
                        "timeOut"
                    )
                );
                RemoveIf(
                    collectUserTimeStampsForCertainTime,
                    Title = "Main Campus"
                );
                ForAll(
                    collectUserTimeStampsForCertainTime,
                    Collect(
                        collectCloseContact,
                        ShowColumns(
                            Filter(
                                UserScanRoom,
                                Title = collectUserTimeStampsForCertainTime[@Title] && collectUserTimeStampsForCertainTime[@timeIN] <= timeOut && timeIN <= collectUserTimeStampsForCertainTime[@timeOut]
                            ),
                            "ID",
                            "userFullName",
                            "userEmail","Title","timeIN","timeOut"
                        )
                    )
                );
                RemoveIf(
                    collectCloseContact,
                    userEmail = TextInput4.Text
                );
                
                ClearCollect(forNotifCollection, Distinct(collectCloseContact, userEmail));
                
                Navigate(adminScreen_ListOfCloseContact,ScreenTransition.Cover);
            PressedBorderColor: =ColorFade(Self.BorderColor, 20%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            RadiusBottomLeft: =15
            RadiusBottomRight: =15
            RadiusTopLeft: =15
            RadiusTopRight: =15
            Size: =13
            Text: ="Find Close Contacts"
            Width: =140
            X: =452
            Y: =481
            ZIndex: =5

    btn_slofcc_1 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =24

        "'htmlText_HealthCheck-up_16' As htmlViewer":
            Height: =81
            HtmlText: |-
                ="<div style='background-color: rgba(0,0,0,0); box-shadow: 0px 2px 4px 0px rgba(89,87,87,0.85); margin: 10px; width: 140px; height: 50px; border-radius: 15px'></div>"
            Width: =165
            X: =447
            Y: =1007
            ZIndex: =22

        Button9_2 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =0
            Color: =RGBA(0, 18, 107, 1)
            DisabledBorderColor: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.'Lato Light'
            Height: =51
            HoverFill: =ColorFade(RGBA(0, 18, 107, 1), 20%)
            OnSelect: |
                =If(
                    IsEmpty(TextInput4.Text) || TextInput4.Text = "Confirmed Covid Patient's XU Email",
                    Notify(
                        "PLEASE INPUT THE REQUIRED AND EXACT DETAILS",
                        NotificationType.Error
                    );
                    ,
                    If(
                        IsEmpty(forNotifCollection),
                        Notify(
                            "Zero Users found, No close contacts",
                            NotificationType.Error
                        );
                        ,
                        ForAll(
                            forNotifCollection,
                            Patch(
                                userMessages,
                                Defaults(userMessages),
                                {
                                    Title: "Admin",
                                    'Sender-Email': "xavieruniversityclinic@my.xu.edu.ph",
                                    Receiver: LookUp(Users_1,Email = forNotifCollection[@Result]).'Full Name',
                                    'Receiver-Email': forNotifCollection[@Result],
                                    Message: input_Message.Text,
                                    MessageType: {
                                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                                        Value: "AdminNotification"
                                    },
                                    DateAndTime: Now()
                                }
                            )
                        );
                        Notify(
                            "ALL USERS ON THE LIST HAVE BEEN NOTIFIED",
                            NotificationType.Success
                        );
                    );
                    
                );
                Reset(input_Message);
                Reset(TextInput4);
            PressedBorderColor: =RGBA(0, 18, 107, 1)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            RadiusBottomLeft: =15
            RadiusBottomRight: =15
            RadiusTopLeft: =15
            RadiusTopRight: =15
            Size: =12
            Text: ="Send Notifications"
            Width: =140
            X: =462
            Y: =1022
            ZIndex: =23

    grp_inputMessage As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =24

        input_Message As text:
            Default: =""
            Fill: =RGBA(237, 237, 237, 1)
            Height: =350
            Mode: =TextMode.MultiLine
            OnChange: =
            OnSelect: =
            Size: =21
            Width: =554
            X: =45
            Y: =645
            ZIndex: =18

        Label21_5 As label:
            Color: =RGBA(0, 13, 75, 1)
            Font: =Font.'Lato Light'
            FontWeight: =FontWeight.Bold
            Height: =23
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: ="Input Message"
            Width: =155
            X: =45
            Y: =622
            ZIndex: =21

    Group1_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =26

        Button15_2 As button:
            BorderColor: =RGBA(230, 230, 230, 1)
            Color: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 18, 107, 1)
            DisabledFill: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0, 18, 107, 1)
            Height: =50
            RadiusBottomLeft: =100
            RadiusBottomRight: =100
            RadiusTopLeft: =100
            RadiusTopRight: =100
            Size: =24
            Text: =""
            Width: =50
            X: =43
            Y: =1023
            ZIndex: =24

        Icon1_2 As icon.Add:
            Color: =RGBA(230, 230, 230, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Height: =35
            Icon: =Icon.QuestionMark
            Width: =35
            X: =50
            Y: =1031
            ZIndex: =25

    Group3_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =29

        "'htmlText_HealthCheck-up_18' As htmlViewer":
            Height: =429
            HtmlText: |-
                ="<div style='background-color: rgba(56, 96, 178, 1); box-shadow: 0px 3px 6px 0px rgba(89,87,87,0.85); margin: 20px; width: 550px; height: 380px; border-radius: 15px'></div>"
            OnSelect: =
            Width: =612
            X: =23
            Y: =342
            ZIndex: =26

        Label24_2 As label:
            Color: =RGBA(227, 234, 243, 1)
            Font: =Font.'Lato Light'
            FontWeight: =FontWeight.Semibold
            Height: =380
            PaddingLeft: =10
            PaddingTop: =30
            Size: =20
            Text: ="Close contacts can be identified through the app by filling up the required inputs such as the from date, to date and the Covid Patient's email address. The results can be exported in csv format through your Microsoft OneDrive Account. All possible contacts can also be notified using the send notification function."
            VerticalAlign: =VerticalAlign.Top
            Width: =556
            X: =43
            Y: =365
            ZIndex: =27

        Icon4_2 As icon.CancelBadge:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(227, 234, 243, 1)
            DisabledBorderColor: =RGBA(179, 179, 179, 1)
            Height: =37
            Icon: =Icon.CancelBadge
            Width: =35
            X: =566
            Y: =365
            ZIndex: =28

